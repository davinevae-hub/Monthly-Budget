<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monthly Budgeting Calculator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: #fff;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2 {
      color: #333;
      text-align: center;
    }
    .section {
      margin-bottom: 30px;
    }
    label {
      display: block;
      margin: 10px 0;
    }
    input {
      margin-left: 10px;
      padding: 5px;
    }
    button {
      margin: 10px 5px 0 0;
      padding: 10px 15px;
      border: none;
      background: #4CAF50;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #45a049;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
    footer {
      text-align: center;
      margin-top: 40px;
      font-size: 0.9em;
      color: #777;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Monthly Budgeting Calculator</h1>

    <!-- Income Section -->
    <div class="section">
      <h2>Income</h2>
      <label>Hourly Pay ($): <input type="number" id="hourlyPay" step="0.01"></label>
      <label>Hours per Week: <input type="number" id="hoursPerWeek"></label>
      <label>Tax Deduction (%): <input type="number" id="taxPercent" step="0.1"></label>
      <button onclick="calculateIncome()">Calculate Net Pay</button>
      <div id="incomeResults"></div>
    </div>

    <!-- Expense Section -->
    <div class="section">
      <h2>Expenses (Biweekly)</h2>
      <div id="expenseList"></div>
      <button onclick="addExpense()">+ Add Expense</button>
      <button onclick="calculateBudget()">Calculate Budget</button>
      <div id="budgetResults"></div>
    </div>

    <!-- Action Buttons -->
    <div class="section">
      <button onclick="downloadReport()">ðŸ“¥ Download PDF</button>
      <button onclick="downloadCSV()">ðŸ“Š Download CSV</button>
      <button onclick="resetAll()">ðŸ”„ Reset All</button>
    </div>

    <footer>
      <p>Created by Davi Nevae LLC</p>
    </footer>
  </div>

  <script>
    const $ = id => document.getElementById(id);

    // Add expense row
    function addExpense() {
      const container = $('expenseList');
      const div = document.createElement('div');
      div.classList.add('expenseRow');
      div.innerHTML = `
        <label>Description: <input type="text" class="desc"></label>
        <label>Amount ($): <input type="number" class="amount" step="0.01"></label>
      `;
      container.appendChild(div);
    }

    // Calculate income
    function calculateIncome() {
      const hourly = parseFloat($('hourlyPay').value) || 0;
      const hours = parseFloat($('hoursPerWeek').value) || 0;
      const tax = (parseFloat($('taxPercent').value) || 0) / 100;

      const gross = hourly * hours * 2; // biweekly gross
      const net = gross * (1 - tax);

      $('incomeResults').innerHTML = `
        <p><b>Gross Pay (Biweekly):</b> $${gross.toFixed(2)}</p>
        <p><b>Net Pay (Biweekly):</b> $${net.toFixed(2)}</p>
        <p><i>*Does not include benefits (insurance, retirement, etc.)</i></p>
      `;
    }

    // Calculate budget and display as table
    function calculateBudget() {
      const descs = [...document.querySelectorAll('.desc')].map(el => el.value || 'Unnamed');
      const amounts = [...document.querySelectorAll('.amount')].map(el => parseFloat(el.value) || 0);
      const totalBiweekly = amounts.reduce((a, b) => a + b, 0);
      const totalMonthly = totalBiweekly * 2;

      let tableHTML = `
        <table>
          <tr><th>Description</th><th>Biweekly ($)</th><th>Monthly ($)</th></tr>
      `;

      amounts.forEach((amt, i) => {
        tableHTML += `
          <tr>
            <td>${descs[i]}</td>
            <td>${amt.toFixed(2)}</td>
            <td>${(amt * 2).toFixed(2)}</td>
          </tr>
        `;
      });

      tableHTML += `
        <tr>
          <th>Total</th>
          <th>$${totalBiweekly.toFixed(2)}</th>
          <th>$${totalMonthly.toFixed(2)}</th>
        </tr>
        </table>
      `;

      $('budgetResults').innerHTML = tableHTML;
    }

    // Download PDF
    function downloadReport() {
      const element = document.createElement('div');
      element.innerHTML = `
        <h1>Monthly Budgeting Report</h1>
        ${$('incomeResults').innerHTML}
        ${$('budgetResults').innerHTML}
      `;

      const opt = {
        margin: 10,
        filename: 'Budgeting_Report.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'pt', format: 'a4', orientation: 'portrait' }
      };

      html2pdf().set(opt).from(element).save();
    }

    // Download CSV
    function downloadCSV() {
      let rows = [["Description", "Biweekly ($)", "Monthly ($)"]];
      const descs = [...document.querySelectorAll('.desc')].map(el => el.value || 'Unnamed');
      const amounts = [...document.querySelectorAll('.amount')].map(el => parseFloat(el.value) || 0);

      amounts.forEach((amt, i) => {
        rows.push([descs[i], amt.toFixed(2), (amt * 2).toFixed(2)]);
      });

      const totalBiweekly = amounts.reduce((a, b) => a + b, 0);
      const totalMonthly = totalBiweekly * 2;
      rows.push(["Total", totalBiweekly.toFixed(2), totalMonthly.toFixed(2)]);

      let csvContent = "data:text/csv;charset=utf-8," 
        + rows.map(e => e.join(",")).join("\n");

      const link = document.createElement("a");
      link.setAttribute("href", encodeURI(csvContent));
      link.setAttribute("download", "Budgeting_Report.csv");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // Reset all fields
    function resetAll() {
      $('hourlyPay').value = '';
      $('hoursPerWeek').value = '';
      $('taxPercent').value = '';
      $('incomeResults').innerHTML = '';
      $('budgetResults').innerHTML = '';
      $('expenseList').innerHTML = '';
    }
  </script>
</body>
</html>
